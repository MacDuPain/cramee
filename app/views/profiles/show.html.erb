<div class="profile-container">
  <h1 class="profile-title">MON COMPTE</h1>
  <div class="profile-content">
    <h2 class="profile-subtitle">PROFIL</h2>
    <!-- Button to toggle edit mode -->
    <%= link_to "MODIFIER", edit_profile_path, class: "btn btn-primary" %>
    <p class="profile-label">Adresse e-mail</p>
    <p class="profile-email"><%= @user.email %></p>
  </div>

  <!-- Form to edit email address -->
  <div id="edit-email-form" style="display: none;">
    <h2 class="profile-subtitle">MODIFIER LE PROFIL</h2>
    <%= form_with(model: @user, url: profile_path, method: :patch) do |form| %>
      <div class="form-group">
        <%= form.label :email, "Nouvelle adresse e-mail" %>
        <%= form.email_field :email, class: "form-control" %>
      </div>
      <button type="submit" class="btn btn-primary">Enregistrer</button>
    <% end %>
  </div>

  <!-- Order History Section -->
<div class="profile-content">
  <h2 class="profile-subtitle">HISTORIQUE DES COMMANDES</h2>
  <% @orders.each do |order| %>
    <div class="order">
      <p>Date: <%= order.created_at.strftime("%d/%m/%Y") %></p>
      <p>Total Price: <%= number_to_currency(order.total_price) %></p>
      <div class="order-items">
        <% order.order_items.each do |order_item| %>
          <div class="order-item">
            <% item = order_item.item %>
            <% if item.image.attached? %>
              <%= image_tag item.image.variant(resize_to_limit: [100, 100]), alt: item.name, class: 'item-thumbnail' %>
            <% end %>
            <p><%= item.name %> x<%= order_item.quantity %></p>
            <p>Prix: <%= number_to_currency(item.price) %></p>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>

